(()=>{"use strict";var e={n:n=>{var r=n&&n.__esModule?()=>n.default:()=>n;return e.d(r,{a:r}),r},d:(n,r)=>{for(var o in r)e.o(r,o)&&!e.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:r[o]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};const n=require("socket.io"),r=require("crypto");var o=e.n(r);const t={randomUUID:o().randomUUID},s=new Uint8Array(256);let c=s.length;function u(){return c>s.length-16&&(o().randomFillSync(s),c=0),s.slice(c,c+=16)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));const i=function(e,n,r){if(t.randomUUID&&!n&&!e)return t.randomUUID();const o=(e=e||{}).random||(e.rng||u)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){r=r||0;for(let e=0;e<16;++e)n[r+e]=o[e];return n}return function(e,n=0){return(a[e[n+0]]+a[e[n+1]]+a[e[n+2]]+a[e[n+3]]+"-"+a[e[n+4]]+a[e[n+5]]+"-"+a[e[n+6]]+a[e[n+7]]+"-"+a[e[n+8]]+a[e[n+9]]+"-"+a[e[n+10]]+a[e[n+11]]+a[e[n+12]]+a[e[n+13]]+a[e[n+14]]+a[e[n+15]]).toLowerCase()}(o)},l=new n.Server(3e3);console.log("Listening on *:3000"),l.sockets.on("connection",(e=>{console.log(`Connected ${e.id}`),e.on("requestLogin",((e,n)=>{console.log(`Login request for '${e.username}'`),n(function(e){if(!d.has(e.username))return!1;let n=g[e.userID];return null!=n&&n.username==e.username}(e))})),e.on("requestRegister",((e,n)=>{console.log(`Register request for '${e}'`),n(function(e){if(d.has(e))return{accepted:!1,reason:"Username already taken"};let n={username:e,userID:i()};return d.add(e),g[n.userID]=n,console.log(`Registered new user '${e}'`),{accepted:!0,userDetails:n}}(e))})),e.on("disconnect",(()=>{console.log(`Disconnected ${e.id}`)}))}));let d=new Set,g={}})();